package nccs.omts.repository;

import java.sql.*;
import java.util.*;
import nccs.omts.*;
import nccs.omts.model.*;

public class MoviesRepository {
	public List<Movies> movies() throws SQLException{
		Connection connection = DBconnection.getConnection();
		Statement statement=connection.createStatement();
		ResultSet rs=statement.executeQuery("Select * from movies");
		List<Movies> movies=new ArrayList<>();
		
		while (rs.next()) {
			Movies movies = new Movies(rs.getInt(1), rs.getInt(3),rs.getString(50),rs.getInt(10),rs.getString(50),rs.getString(50),rs.getInt(10));
			movies.add(movies);
		}
		return movies;
	}
	public void addToMovies(int movie_id,int genre_id,String movie_name,int length,String director,String cast,int rating) throws SQLException{
		Connection connection= DBconnection.getConnection();
		Statement statement=connection.createStatement();
		statement.excuteUpdate("INSERT INTO movies values("+movie_id+","+genre_id+","+movie_name+","+length+","+director+","+cast+","+rating+")");
	}
}
